{% extends "base.html" %}

{% set current_page = 'contest' %}

{% block content %}

  {% import "macros/list_games.html" as list_games %}

  {% if message is not null %}
    <div class="alert alert-success">
      {{message}}
    </div>
  {% endif %}

  <h2>{{contest.name}}</h2>

  {% if contest.creator == user_logged_in.playerid %}
    <a href="{{base_path}}/contest/{{contest.contestid}}/edit" class="btn btn-default btn-xs" role="button">Muokkaa</a>

    <br><br>

    <form method="post" action="{{base_path}}/contest/{{contest.contestid}}/add">
      <label>Lisää peli viidestä uusimmasta tai antamalla pelin ID</label>
      <div class="row">
        <div class="col-xs-2">
          <select class="form-control" name="gameid">
            {% for game in latest_games %}
              <option value="{{game.gameid}}">
                {{game.gamedate|date("d.m.Y H:i")}} {{game.course.name}}, {{game.course.city}}
                {% if game.contest_name %}
                  (Kisassa {{game.contest_name}})
                {% endif %}
              </option>
            {% endfor %}
          </select>
        </div>

        <button type="submit" class="btn btn-default">Lisää peli</button>
      </div>
    </form>

    {% if games %}

      <h3>Pisteet</h3>

      <table class="table table-striped table-bordered">
        <thead>
          <tr>
            <th>Sija</th>
            <th>Pelaaja</th>
              {% for contest_num in 1..contest.number_of_games %}
                <th>#{{contest_num}}</th>
              {% endfor %}
            <th>Yhteensä</th>
          </tr>
        </thead>

        <tbody>
            <tr>
            </tr>
        </tbody>
      </table>

      <h3>Pelit</h3>

      {{list_games.list_games(games, players, base_path, admin_logged_in, show_edit)}}
    {% else %}
      Kisassa ei ole yhtään peliä.
    {% endif %}

  {% endif %}

{% endblock %}
